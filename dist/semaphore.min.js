/*! SemaphoreJs v1.0.0, created by: Jason Holt Smith <bicarbon8@gmail.com> 2015-01-03 14:14:23 */

var SemaphoreJs={RETRY_MS:10,MUTEX:{_lock:function(a,b,c){"use strict";this.id=a,this.name=b,this.expiresAt=c},_locks:[],get:function(a,b){"use strict";var c=void 0,d=!1,e=SemaphoreJs.MUTEX._get(a);if(b&&(c=(new Date).getTime()+b),e?e.expiresAt&&e.expiresAt<(new Date).getTime()&&(d=!0):d=!0,d){var f=SemaphoreJs.MUTEX._guid();return SemaphoreJs.MUTEX._locks.push(new SemaphoreJs.MUTEX._lock(f,a,c)),f}return void 0},release:function(a){"use strict";SemaphoreJs.MUTEX._locks=SemaphoreJs.MUTEX._locks.filter(function(b){return b.id!==a})},_get:function(a){"use strict";for(var b in SemaphoreJs.MUTEX._locks)if(SemaphoreJs.MUTEX._locks[b].name===a)return SemaphoreJs.MUTEX._locks[b];return void 0},_guid:function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}},lock:function(a,b,c,d){"use strict";var e=-1;c&&"number"==typeof c&&(e=(new Date).getTime()+c),SemaphoreJs._get(a,b,d,e,void 0)},lockFor:function(a,b,c){"use strict";SemaphoreJs._get(a,b,function(){},-1,c)},release:function(a){"use strict";SemaphoreJs.MUTEX.release(a)},_get:function(a,b,c,d,e){"use strict";var f=SemaphoreJs.MUTEX.get(a,e);if(f)b(f);else if(-1===d||(new Date).getTime()+SemaphoreJs.RETRY_MS<d)setTimeout(function(){SemaphoreJs._get(a,b,c,d,e)},SemaphoreJs.RETRY_MS);else{var g="unable to acquire lock for: "+a;if(!c)throw g;c(g)}}};
//# sourceMappingURL=semaphore.min.js.map