/*! MutexJs v1.0.0, created by: Jason Holt Smith <bicarbon8@gmail.com> 2015-02-06 23:24:31 */

var MutexJs={RETRY_MS:10,Semaphore:{_locks:[],_lock:function(a,b,c){"use strict";this.id=a,this.name=b,this.expiresAt=c},get:function(a,b){"use strict";var c=null,d=!1,e=MutexJs.Semaphore._get(a);if(b&&(c=(new Date).getTime()+b),e?e.expiresAt&&e.expiresAt<(new Date).getTime()&&(d=!0):d=!0,d){var f=MutexJs.Semaphore._guid();return MutexJs.Semaphore._locks.push(new MutexJs.Semaphore._lock(f,a,c)),f}return null},release:function(a){"use strict";MutexJs.Semaphore._locks=MutexJs.Semaphore._locks.filter(function(b){return b.id!==a})},_get:function(a){"use strict";for(var b in MutexJs.Semaphore._locks)if(MutexJs.Semaphore._locks[b].name===a)return MutexJs.Semaphore._locks[b];return null},_guid:function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}},lock:function(a,b,c,d){"use strict";var e=-1;c&&"number"==typeof c&&(e=(new Date).getTime()+c),MutexJs._get(a,b,d,e,void 0)},lockFor:function(a,b,c){"use strict";MutexJs._get(a,b,function(){},-1,c)},release:function(a){"use strict";MutexJs.Semaphore.release(a)},_get:function(a,b,c,d,e){"use strict";var f=MutexJs.Semaphore.get(a,e);if(f)b(f);else if(-1===d||(new Date).getTime()+MutexJs.RETRY_MS<d)setTimeout(function(){MutexJs._get(a,b,c,d,e)},MutexJs.RETRY_MS);else{var g="unable to acquire lock for: "+a;if(!c)throw g;c(g)}}},module=module||{};module.exports=MutexJs;
//# sourceMappingURL=mutex.min.js.map